{
    "template": "{ \"_source\": { \"includes\": [ \"id\" ] }, \"size\": {{size}}, \"from\": {{from}}, \"query\": { \"bool\": { \"must\": [ { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"must\": [ { \"term\": { \"content.id\": \"{{id}}\" } } {{#source}}, { \"nested\": { \"path\": \"content.association\", \"query\": { \"term\": { \"content.association.type\": \"source\" } } } } {{/source}} {{#creator}}, { \"nested\": { \"path\": \"content.association\", \"query\": { \"term\": { \"content.association.type\": \"author\" } } } } {{/creator}} {{#franchise}}, { \"bool\": { \"should\": [ { \"nested\": { \"path\": \"content.association\", \"query\": { \"term\": { \"content.association.type\": { \"value\": \"section\", \"boost\": 1.75 } } } } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"term\": { \"content.association.type\": { \"value\": \"tags\", \"boost\": 1.25 } } } } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"term\": { \"content.association.type\": { \"value\": \"related\", \"boost\": 1 } } } } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"term\": { \"content.association.type\": { \"value\": \"additional_sections\", \"boost\": 1.5 } } } } } ] } } {{/franchise}} {{#person}}, { \"bool\": { \"should\": [ { \"nested\": { \"path\": \"content.association\", \"query\": { \"term\": { \"content.association.type\": { \"value\": \"tags\" } } } } } ] } } {{/person}} {{#organization}}, { \"bool\": { \"should\": [ { \"nested\": { \"path\": \"content.association\", \"query\": { \"term\": { \"content.association.type\": { \"value\": \"tags\" } } } } } ] } } {{/organization}} {{#company}}, { \"bool\": { \"should\": [ { \"nested\": { \"path\": \"content.association\", \"query\": { \"term\": { \"content.association.type\": { \"value\": \"tags\" } } } } } ] } } {{/company}} {{#security}}, { \"bool\": { \"should\": [ { \"nested\": { \"path\": \"content.association\", \"query\": { \"term\": { \"content.association.type\": { \"value\": \"tags\" } } } } } ] } } {{/security}} {{#place}}, { \"bool\": { \"should\": [ { \"nested\": { \"path\": \"content.association\", \"query\": { \"term\": { \"content.association.type\": { \"value\": \"tags\" } } } } } ] } } {{/place}} {{#event}}, { \"bool\": { \"should\": [ { \"nested\": { \"path\": \"content.association\", \"query\": { \"term\": { \"content.association.type\": { \"value\": \"tags\" } } } } } ] } } {{/event}} ] } } } }, { \"terms\" : { \"type\" : [ \"cnbcvideo\", \"cnbcnewsstory\", \"blogpost\", \"slideshow\", \"partnerstory\", \"sponsored\", \"episode\", \"pressrelease\", \"quiz\", \"wirestory\" ] } } ] } } {{#sortBy}}, \"sort\": { \"dates.{{sortBy}}\" : {\"order\" : \"desc\"}}{{/sortBy}} } "
}