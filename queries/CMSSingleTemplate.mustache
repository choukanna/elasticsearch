{ 
	"template": "{ \"size\": {{size}}, \"from\": {{from}}, {{#sortBy}} {{#datelineSort}} \"sort\": { \"dates.{{sortBy}}\": \"{{sortOrder}}\" }, {{/datelineSort}} {{#createdDateSort}} \"sort\": { \"dates.{{sortBy}}\": \"{{sortOrder}}\" }, {{/createdDateSort}} {{#lastPubDateSort}} \"sort\": { \"dates.{{sortBy}}\": \"{{sortOrder}}\" }, {{/lastPubDateSort}} {{#updatedDateSort}} \"sort\": { \"dates.{{sortBy}}\": \"{{sortOrder}}\" }, {{/updatedDateSort}} {{#unpublishDateSort}} \"sort\": { \"dates.{{sortBy}}\": \"{{sortOrder}}\" }, {{/unpublishDateSort}} {{#lastUsedSort}} \"sort\": { \"lastUsed\": \"{{sortOrder}}\" }, {{/lastUsedSort}} {{#relevanceSort}} \"sort\": { \"_score\": \"{{sortOrder}}\" }, {{/relevanceSort}} {{#authorSort}} \"sort\": { \"content.tagName\": { \"order\" : \"{{sortOrder}}\", \"mode\": \"min\", \"nested_path\" : \"content\", \"nested_filter\" : { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"author\" } } } } } } } }, {{/authorSort}} {{#videoDurationSort}} \"sort\": { \"videoDuration\": \"{{sortOrder}}\" }, {{/videoDurationSort}} {{#stateSort}} \"sort\": { \"state\": \"{{sortOrder}}\" }, {{/stateSort}} {{/sortBy}} \"query\": { \"bool\": { {{#searchPhrase}} \"must\": { {{^sortBy}} \"function_score\": { \"query\": { {{/sortBy}} \"match\": { \"{{searchByField}}\": { \"query\": \"{{searchPhrase}}\", \"_name\": \"{{searchByField}}\", \"operator\": \"and\" } } {{^sortBy}} }, \"gauss\": { \"dates.dateline\": { \"scale\": \"60d\", \"offset\": \"1d\", \"decay\": 0.7 } } } {{/sortBy}} }, {{/searchPhrase}} \"filter\": { \"bool\": { \"must\": [ {{#dateType}} {{#byTimePeriod}} {{#timePeriod}} { \"range\": { \"dates.{{dateType}}\": { \"gt\": \"now-{{timePeriod}}{{timeUnit}}{{^timeUnit}}d{{/timeUnit}}\", \"lt\": \"now\" } } }, {{/timePeriod}} {{/byTimePeriod}} {{^byTimePeriod}} {{#byDateRange}} { \"range\": { \"dates.{{dateType}}\": { {{#fromDate}}\"gte\": \"{{fromDate}}\",{{/fromDate}} {{#toDate}}\"lte\": \"{{toDate}}\",{{/toDate}} \"format\": \"MM-dd-yyyy\" } } }, {{/byDateRange}} {{/byTimePeriod}} {{/dateType}} {{#stateAndList}} { \"term\": { \"state\": \"{{stateAnd}}\" } }, {{/stateAndList}} {{#editedByAndList}} { \"term\": { \"editedBy\": \"{{editedByAnd}}\" } }, {{/editedByAndList}} {{#createdByAndList}} { \"term\": { \"createdBy\": \"{{createdByAnd}}\" } }, {{/createdByAndList}} {{#contemplateAndList}} { \"term\": { \"isContemplate\": \"{{contemplateAnd}}\" } }, {{/contemplateAndList}} {{#licensedAndList}} { \"term\": { \"licensed\": \"{{licensedAnd}}\" } }, {{/licensedAndList}} {{#contentTypeAndList}} { \"term\": { \"type\": \"{{contentTypeAnd}}\" } }, {{/contentTypeAndList}} {{#subTypeAndList}} { \"term\": { \"subType\": \"{{subTypeAnd}}\" } }, {{/subTypeAndList}} {{#brandAndList}} { \"term\": { \"branding\": \"{{brandAnd}}\" } }, {{/brandAndList}} {{#usageRightsAndList}} { \"term\": { \"usageRights\": \"{{usageRightsAnd}}\" } }, {{/usageRightsAndList}} {{#photoTypeAndList}} { \"term\": { \"photoType\": \"{{photoTypeAnd}}\" } }, {{/photoTypeAndList}} {{#idAndList}} { \"term\": { \"id\": \"{{idAnd}}\" } }, {{/idAndList}} {{#keywordsAndList}} { \"match\": { \"keywords\": \"{{keywordsAnd}}\" } }, {{/keywordsAndList}} {{#assocAndList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"bool\":{ \"should\":[ { \"term\": { \"content.tagName\": \"{{assocAnd}}\" } }, { \"term\": { \"content.id\": \"{{assocAnd}}\" } } ] } }, { \"bool\": { \"should\": [ { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"section\" } } } } } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"related\" } } } } } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"additional_sections\" } } } } } } ] } } ] } } } }, {{/assocAndList}} {{#sectionSubTypeAndList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.subType\": \"{{sectionSubTypeAnd}}\" } }, \"should\": [ { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"section\" } } } } } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"additional_sections\" } } } } } } ] } } } }, {{/sectionSubTypeAndList}} {{#authorAndList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"should\":[ { \"term\": { \"content.tagName\": \"{{authorAnd}}\" } }, { \"term\": { \"content.id\": \"{{authorAnd}}\" } } ], \"filter\":{ \"nested\": { \"path\": \"content.association\", \"query\": { \"term\": { \"content.association.type\": \"author\" } } } } } } } }, {{/authorAndList}} {{#sourceAndList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"should\":[ { \"term\": { \"content.tagName\": \"{{sourceAnd}}\" } }, { \"term\": { \"content.id\": \"{{sourceAnd}}\" } } ], \"filter\": { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"source\" } } } } } } } } } }, {{/sourceAndList}} {{#usageRuleAndList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"should\":[ { \"term\": { \"content.tagName\": \"{{usageRuleAnd}}\" } }, { \"term\": { \"content.id\": \"{{usageRuleAnd}}\" } } ], \"filter\":{ \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"usageRule\" } } } } } } } } } }, {{/usageRuleAndList}} {{#sectionAndList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"should\":[ { \"term\": { \"content.tagName\": \"{{sectionAnd}}\" } }, { \"term\": { \"content.id\": \"{{sectionAnd}}\" } } ], \"filter\":{ \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"section\" } } } } } } } } } }, {{/sectionAndList}} {{#secondarySectionAndList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"should\":[ { \"term\": { \"content.tagName\": \"{{secondarySectionAnd}}\" } }, { \"term\": { \"content.id\": \"{{secondarySectionAnd}}\" } } ], \"filter\": { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"additional_sections\" } } } } } } } } } }, {{/secondarySectionAndList}} {{#tagAndList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"should\":[ { \"term\": { \"content.tagName\": \"{{tagAnd}}\" } }, { \"term\": { \"content.id\": \"{{tagAnd}}\" } } ], \"filter\": { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } } } } } }, {{/tagAndList}} {{#personAndList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"bool\":{ \"should\":[ { \"term\": { \"content.tagName\": \"{{personAnd}}\" } }, { \"term\": { \"content.id\": \"{{personAnd}}\" } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\":{ \"should\": [ { \"term\": { \"content.type\": \"person\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"person\" } } ] } } ] } } ] } } } }, {{/personAndList}} {{#companyAndList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"bool\":{ \"should\":[ { \"term\": { \"content.tagName\": \"{{companyAnd}}\" } }, { \"term\": { \"content.id\": \"{{companyAnd}}\" } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\":{ \"should\": [ { \"term\": { \"content.type\": \"company\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"company\" } } ] } } ] } } ] } } } }, {{/companyAndList}} {{#securityAndList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"bool\":{ \"should\":[ { \"term\": { \"content.tagName\": \"{{securityAnd}}\" } }, { \"term\": { \"content.id\": \"{{securityAnd}}\" } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\":{ \"should\": [ { \"term\": { \"content.type\": \"security\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"security\" } } ] } } ] } } ] } } } }, {{/securityAndList}} {{#topicAndList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"bool\":{ \"should\":[ { \"term\": { \"content.tagName\": \"{{topicAnd}}\" } }, { \"term\": { \"content.id\": \"{{topicAnd}}\" } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\":{ \"should\": [ { \"term\": { \"content.type\": \"topic\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"topic\" } } ] } } ] } } ] } } } }, {{/topicAndList}} {{#placeAndList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"bool\":{ \"should\":[ { \"term\": { \"content.tagName\": \"{{placeAnd}}\" } }, { \"term\": { \"content.id\": \"{{placeAnd}}\" } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\":{ \"should\": [ { \"term\": { \"content.type\": \"place\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"place\" } } ] } } ] } } ] } } } }, {{/placeAndList}} {{#organizationAndList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"bool\":{ \"should\":[ { \"term\": { \"content.tagName\": \"{{organizationAnd}}\" } }, { \"term\": { \"content.id\": \"{{organizationAnd}}\" } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\":{ \"should\": [ { \"term\": { \"content.type\": \"organization\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"organization\" } } ] } } ] } } ] } } } }, {{/organizationAndList}} {{#eventAndList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"bool\":{ \"should\":[ { \"term\": { \"content.tagName\": \"{{eventAnd}}\" } }, { \"term\": { \"content.id\": \"{{eventAnd}}\" } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\":{ \"should\": [ { \"term\": { \"content.type\": \"event\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"event\" } } ] } } ] } } ] } } } }, {{/eventAndList}} {{#showAndList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"bool\":{ \"should\":[ { \"term\": { \"content.tagName\": \"{{showAnd}}\" } }, { \"term\": { \"content.id\": \"{{showAnd}}\" } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\": { \"should\": [ { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"franchise\" } }, { \"bool\":{ \"should\":[ { \"term\": { \"content.subType\": \"news_show\" } }, { \"term\": { \"content.subType\": \"primetime_show\" } }, { \"term\": { \"content.subType\": \"original_show\" } }, { \"term\": { \"content.subType\": \"weekly_show\" } } ] } } ] } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"bool\":{ \"should\":[ { \"term\": { \"content.subType\": \"news_show\" } }, { \"term\": { \"content.subType\": \"primetime_show\" } }, { \"term\": { \"content.subType\": \"original_show\" } }, { \"term\": { \"content.subType\": \"weekly_show\" } } ] } } ] } } ] } } ] } } } }, {{/showAndList}} {{#internalAndList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"bool\":{ \"should\":[ { \"term\": { \"content.tagName\": \"{{internalAnd}}\" } }, { \"term\": { \"content.id\": \"{{internalAnd}}\" } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\":{ \"should\": [ { \"term\": { \"content.type\": \"internal\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"internal\" } } ] } } ] } } ] } } } }, {{/internalAndList}} {{#symbolAndList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\":[ { \"term\": { \"content.id\": \"{{symbolAnd}}\" } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } } ], \"should\": [ { \"term\": { \"content.type\": \"company\" } }, { \"term\": { \"content.type\": \"security\" } }, { \"bool\":{ \"filter\":{ \"term\": { \"content.type\": \"tag\" } }, \"should\":[ { \"term\": { \"content.subType\": \"company\" } }, { \"term\": { \"content.subType\": \"security\" } } ] } } ] } } } }, {{/symbolAndList}} {{#subTypeOr}} { \"terms\": { \"subType\": {{#toJson}}subTypeOrList{{/toJson}} } }, {{/subTypeOr}} {{#assocOr}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"bool\":{ \"should\":[ { \"terms\": { \"content.tagName\": {{#toJson}}assocOrList{{/toJson}} } }, { \"terms\": { \"content.id\": {{#toJson}}assocOrList{{/toJson}} } } ] } }, { \"bool\": { \"should\": [ { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"section\" } } } } } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"related\" } } } } } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"additional_sections\" } } } } } } ] } } ] } } } }, {{/assocOr}} {{#sectionSubTypeOr}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"terms\": { \"content.subType\": {{#toJson}}sectionSubTypeOrList{{/toJson}} } }, { \"bool\": { \"should\": [ { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"section\" } } } } } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"additional_sections\" } } } } } } ] } } ] } } } }, {{/sectionSubTypeOr}} {{#brandOr}} { \"terms\": { \"branding\": {{#toJson}}brandOrList{{/toJson}} } }, {{/brandOr}} {{#photoTypeOr}} { \"terms\": { \"photoType\": {{#toJson}}photoTypeOrList{{/toJson}} } }, {{/photoTypeOr}} {{#usageRightsOr}} { \"terms\": { \"usageRights\": {{#toJson}}usageRightsOrList{{/toJson}} } }, {{/usageRightsOr}} {{#idOr}} { \"terms\": { \"id\": {{#toJson}}idOrList{{/toJson}} } }, {{/idOr}} {{#authorOr}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"should\":[ { \"terms\": { \"content.tagName\": {{#toJson}}authorOrList{{/toJson}} } }, { \"terms\": { \"content.id\": {{#toJson}}authorOrList{{/toJson}} } } ], \"filter\":{ \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"author\" } } } } } } } } } }, {{/authorOr}} {{#contentTypeOr}} { \"terms\": { \"type\": {{#toJson}}contentTypeOrList{{/toJson}} } }, {{/contentTypeOr}} {{#stateOr}} { \"terms\": { \"state\": {{#toJson}}stateOrList{{/toJson}} } }, {{/stateOr}} {{#createdByOr}} { \"terms\": { \"createdBy\": {{#toJson}}createdByOrList{{/toJson}} } }, {{/createdByOr}} {{#editedByOr}} { \"terms\": { \"editedBy\": {{#toJson}}editedByOrList{{/toJson}} } }, {{/editedByOr}} {{#contemplateOr}} { \"terms\": { \"isContemplate\": {{#toJson}}contemplateOrList{{/toJson}} } }, {{/contemplateOr}} {{#licensedOr}} { \"terms\": { \"licensed\": {{#toJson}}licensedOrList{{/toJson}} } }, {{/licensedOr}} {{#keywordsOr}} { \"match\": { \"keywords\": {{#toJson}}keywordsOrList{{/toJson}} } }, {{/keywordsOr}} {{#sourceOr}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"should\":[ { \"terms\": { \"content.tagName\": {{#toJson}}sourceOrList{{/toJson}} } }, { \"terms\": { \"content.id\": {{#toJson}}sourceOrList{{/toJson}} } } ], \"filter\":{ \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"source\" } } } } } } } } } }, {{/sourceOr}} {{#usageRuleOr}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"should\":[ { \"terms\": { \"content.tagName\": {{#toJson}}usageRuleOrList{{/toJson}} } }, { \"terms\": { \"content.id\": {{#toJson}}usageRuleOrList{{/toJson}} } } ], \"filter\":{ \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"usageRule\" } } } } } } } } } }, {{/usageRuleOr}} {{#sectionOr}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"should\":[ { \"terms\": { \"content.tagName\": {{#toJson}}sectionOrList{{/toJson}} } }, { \"terms\": { \"content.id\": {{#toJson}}sectionOrList{{/toJson}} } } ], \"filter\": { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"section\" } } } } } } } } } }, {{/sectionOr}} {{#secondarySectionOr}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"should\":[ { \"terms\": { \"content.tagName\": {{#toJson}}secondarySectionOrList{{/toJson}} } }, { \"terms\": { \"content.id\": {{#toJson}}secondarySectionOrList{{/toJson}} } } ], \"filter\": { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"additional_sections\" } } } } } } } } } }, {{/secondarySectionOr}} {{#symbolOr}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\":[ { \"terms\": { \"content.id\": {{#toJson}}symbolOrList{{/toJson}} } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } } ], \"should\": [ { \"term\": { \"content.type\": \"company\" } }, { \"term\": { \"content.type\": \"security\" } }, { \"bool\":{ \"filter\":{ \"term\": { \"content.type\": \"tag\" } }, \"should\":[ { \"term\": { \"content.subType\": \"company\" } }, { \"term\": { \"content.subType\": \"security\" } } ] } } ] } } } }, {{/symbolOr}} {{#personOr}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\":[ { \"bool\":{ \"should\":[ { \"terms\": { \"content.tagName\": {{#toJson}}personOrList{{/toJson}} } }, { \"terms\": { \"content.id\": {{#toJson}}personOrList{{/toJson}} } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\": { \"should\": [ { \"term\": { \"content.type\": \"person\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"person\" } } ] } } ] } } ] } } } }, {{/personOr}} {{#companyOr}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\":[ { \"bool\":{ \"should\":[ { \"terms\": { \"content.tagName\": {{#toJson}}companyOrList{{/toJson}} } }, { \"terms\": { \"content.id\": {{#toJson}}companyOrList{{/toJson}} } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\": { \"should\": [ { \"term\": { \"content.type\": \"company\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"company\" } } ] } } ] } } ] } } } }, {{/companyOr}} {{#securityOr}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\":[ { \"bool\":{ \"should\":[ { \"terms\": { \"content.tagName\": {{#toJson}}securityOrList{{/toJson}} } }, { \"terms\": { \"content.id\": {{#toJson}}securityOrList{{/toJson}} } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\": { \"should\": [ { \"term\": { \"content.type\": \"security\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"security\" } } ] } } ] } } ] } } } }, {{/securityOr}} {{#topicOr}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\":[ { \"bool\":{ \"should\":[ { \"terms\": { \"content.tagName\": {{#toJson}}topicOrList{{/toJson}} } }, { \"terms\": { \"content.id\": {{#toJson}}topicOrList{{/toJson}} } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\": { \"should\": [ { \"term\": { \"content.type\": \"topic\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"topic\" } } ] } } ] } } ] } } } }, {{/topicOr}} {{#placeOr}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\":[ { \"bool\":{ \"should\":[ { \"terms\": { \"content.tagName\": {{#toJson}}placeOrList{{/toJson}} } }, { \"terms\": { \"content.id\": {{#toJson}}placeOrList{{/toJson}} } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\": { \"should\": [ { \"term\": { \"content.type\": \"place\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"place\" } } ] } } ] } } ] } } } }, {{/placeOr}} {{#organizationOr}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\":[ { \"bool\":{ \"should\":[ { \"terms\": { \"content.tagName\": {{#toJson}}organizationOrList{{/toJson}} } }, { \"terms\": { \"content.id\": {{#toJson}}organizationOrList{{/toJson}} } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\": { \"should\": [ { \"term\": { \"content.type\": \"organization\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"organization\" } } ] } } ] } } ] } } } }, {{/organizationOr}} {{#eventOr}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\":[ { \"bool\":{ \"should\":[ { \"terms\": { \"content.tagName\": {{#toJson}}eventOrList{{/toJson}} } }, { \"terms\": { \"content.id\": {{#toJson}}eventOrList{{/toJson}} } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\": { \"should\": [ { \"term\": { \"content.type\": \"event\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"event\" } } ] } } ] } } ] } } } }, {{/eventOr}} {{#showOr}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\":[ { \"bool\":{ \"should\":[ { \"terms\": { \"content.tagName\": {{#toJson}}showOrList{{/toJson}} } }, { \"terms\": { \"content.id\": {{#toJson}}showOrList{{/toJson}} } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\": { \"should\": [ { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"franchise\" } }, { \"bool\":{ \"should\":[ { \"term\": { \"content.subType\": \"news_show\" } }, { \"term\": { \"content.subType\": \"primetime_show\" } }, { \"term\": { \"content.subType\": \"original_show\" } }, { \"term\": { \"content.subType\": \"weekly_show\" } } ] } } ] } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"bool\":{ \"should\":[ { \"term\": { \"content.subType\": \"news_show\" } }, { \"term\": { \"content.subType\": \"primetime_show\" } }, { \"term\": { \"content.subType\": \"original_show\" } }, { \"term\": { \"content.subType\": \"weekly_show\" } } ] } } ] } } ] } } ] } } } }, {{/showOr}} {{#internalOr}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\":[ { \"bool\":{ \"should\":[ { \"terms\": { \"content.tagName\": {{#toJson}}internalOrList{{/toJson}} } }, { \"terms\": { \"content.id\": {{#toJson}}internalOrList{{/toJson}} } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\": { \"should\": [ { \"term\": { \"content.type\": \"internal\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"internal\" } } ] } } ] } } ] } } } }, {{/internalOr}} {{#tagOr}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"should\":[ { \"terms\": { \"content.tagName\": {{#toJson}}tagOrList{{/toJson}} } }, { \"terms\": { \"content.id\": {{#toJson}}tagOrList{{/toJson}} } } ], \"filter\": { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } } } } } }, {{/tagOr}} {} ], \"must_not\": [ {{#contentTypeNotList}} { \"term\": { \"type\": \"{{contentTypeNot}}\" } }, {{/contentTypeNotList}} {{#stateNotList}} { \"term\": { \"state\": \"{{stateNot}}\" } }, {{/stateNotList}} {{#editedByNotList}} { \"term\": { \"editedBy\": \"{{editedByNot}}\" } }, {{/editedByNotList}} {{#createdByNotList}} { \"term\": { \"createdBy\": \"{{createdByNot}}\" } }, {{/createdByNotList}} {{#contemplateNotList}} { \"term\": { \"isContemplate\": \"{{contemplateNot}}\" } }, {{/contemplateNotList}} {{#licensedNotList}} { \"term\": { \"licensed\": \"{{licensedNot}}\" } }, {{/licensedNotList}} {{#brandNotList}} { \"term\": { \"branding\": \"{{brandNot}}\" } }, {{/brandNotList}} {{#idNotList}} { \"term\": { \"id\": \"{{idNot}}\" } }, {{/idNotList}} {{#usageRightsNotList}} { \"term\": { \"usageRights\": \"{{usageRightsNot}}\" } }, {{/usageRightsNotList}} {{#photoTypeNotList}} { \"term\": { \"photoType\": \"{{photoTypeNot}}\" } }, {{/photoTypeNotList}} {{#subTypeNotList}} { \"term\": { \"subType\": \"{{subTypeNot}}\" } }, {{/subTypeNotList}} {{#keywordsNotList}} { \"match\": { \"keywords\": \"{{keywordsNot}}\" } }, {{/keywordsNotList}} {{#assocNotList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"term\": { \"content.tagName\": \"{{assocNot}}\" } }, { \"bool\": { \"should\": [ { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"section\" } } } } } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"related\" } } } } } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"additional_sections\" } } } } } } ] } } ] } } } }, { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"term\": { \"content.id\": \"{{assocNot}}\" } }, { \"bool\": { \"should\": [ { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"section\" } } } } } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"related\" } } } } } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"additional_sections\" } } } } } } ] } } ] } } } }, {{/assocNotList}} {{#sectionSubTypeNotList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.subType\": \"{{sectionSubTypeNot}}\" } }, \"should\": [ { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"section\" } } } } } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"additional_sections\" } } } } } } ] } } } }, {{/sectionSubTypeNotList}} {{#authorNotList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"term\": { \"content.tagName\": \"{{authorNot}}\" } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"author\" } } } } } } ] } } } }, { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"term\": { \"content.id\": \"{{authorNot}}\" } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"author\" } } } } } } ] } } } }, {{/authorNotList}} {{#sourceNotList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"term\": { \"content.tagName\": \"{{sourceNot}}\" } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"source\" } } } } } } ] } } } }, { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"term\": { \"content.id\": \"{{sourceNot}}\" } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"source\" } } } } } } ] } } } }, {{/sourceNotList}} {{#usageRuleNotList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"term\": { \"content.tagName\": \"{{usageRuleNot}}\" } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"usageRule\" } } } } } } ] } } } }, { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"term\": { \"content.id\": \"{{usageRuleNot}}\" } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"usageRule\" } } } } } } ] } } } }, {{/usageRuleNotList}} {{#sectionNotList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"term\": { \"content.tagName\": \"{{sectionNot}}\" } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"section\" } } } } } } ] } } } }, { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"term\": { \"content.id\": \"{{sectionNot}}\" } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"section\" } } } } } } ] } } } }, {{/sectionNotList}} {{#secondarySectionNotList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"term\": { \"content.tagName\": \"{{secondarySectionNot}}\" } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"additional_sections\" } } } } } } ] } } } }, { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"term\": { \"content.id\": \"{{secondarySectionNot}}\" } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"additional_sections\" } } } } } } ] } } } }, {{/secondarySectionNotList}} {{#symbolNotList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"term\": { \"content.id\": \"{{symbolNot}}\" } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } } ], \"should\": [ { \"term\": { \"content.type\": \"company\" } }, { \"term\": { \"content.type\": \"security\" } }, { \"bool\":{ \"filter\":{ \"term\": { \"content.type\": \"tag\" } }, \"should\":[ { \"term\": { \"content.subType\": \"company\" } }, { \"term\": { \"content.subType\": \"security\" } } ] } } ] } } } }, {{/symbolNotList}} {{#personNotList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"bool\":{ \"should\":[ { \"term\": { \"content.tagName\": \"{{personNot}}\" } }, { \"term\": { \"content.id\": \"{{personNot}}\" } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\": { \"should\": [ { \"term\": { \"content.type\": \"person\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"person\" } } ] } } ] } } ] } } } }, {{/personNotList}} {{#internalNotList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"bool\":{ \"should\":[ { \"term\": { \"content.tagName\": \"{{internalNot}}\" } }, { \"term\": { \"content.id\": \"{{internalNot}}\" } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\": { \"should\": [ { \"term\": { \"content.type\": \"internal\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"internal\" } } ] } } ] } } ] } } } }, {{/internalNotList}} {{#companyNotList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"bool\":{ \"should\":[ { \"term\": { \"content.tagName\": \"{{companyNot}}\" } }, { \"term\": { \"content.id\": \"{{companyNot}}\" } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\": { \"should\": [ { \"term\": { \"content.type\": \"company\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"company\" } } ] } } ] } } ] } } } }, {{/companyNotList}} {{#securityNotList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"bool\":{ \"should\":[ { \"term\": { \"content.tagName\": \"{{securityNot}}\" } }, { \"term\": { \"content.id\": \"{{securityNot}}\" } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\": { \"should\": [ { \"term\": { \"content.type\": \"security\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"security\" } } ] } } ] } } ] } } } }, {{/securityNotList}} {{#topicNotList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"bool\":{ \"should\":[ { \"term\": { \"content.tagName\": \"{{topicNot}}\" } }, { \"term\": { \"content.id\": \"{{topicNot}}\" } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\": { \"should\": [ { \"term\": { \"content.type\": \"topic\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"topic\" } } ] } } ] } } ] } } } }, {{/topicNotList}} {{#placeNotList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"bool\":{ \"should\":[ { \"term\": { \"content.tagName\": \"{{placeNot}}\" } }, { \"term\": { \"content.id\": \"{{placeNot}}\" } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\": { \"should\": [ { \"term\": { \"content.type\": \"place\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"place\" } } ] } } ] } } ] } } } }, {{/placeNotList}} {{#organizationNotList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"bool\":{ \"should\":[ { \"term\": { \"content.tagName\": \"{{organizationNot}}\" } }, { \"term\": { \"content.id\": \"{{organizationNot}}\" } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\": { \"should\": [ { \"term\": { \"content.type\": \"organization\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"organization\" } } ] } } ] } } ] } } } }, {{/organizationNotList}} {{#showNotList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"bool\":{ \"should\":[ { \"term\": { \"content.tagName\": \"{{showNot}}\" } }, { \"term\": { \"content.id\": \"{{showNot}}\" } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\": { \"should\": [ { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"franchise\" } }, { \"bool\":{ \"should\":[ { \"term\": { \"content.subType\": \"news_show\" } }, { \"term\": { \"content.subType\": \"primetime_show\" } }, { \"term\": { \"content.subType\": \"original_show\" } }, { \"term\": { \"content.subType\": \"weekly_show\" } } ] } } ] } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"bool\":{ \"should\":[ { \"term\": { \"content.subType\": \"news_show\" } }, { \"term\": { \"content.subType\": \"primetime_show\" } }, { \"term\": { \"content.subType\": \"original_show\" } }, { \"term\": { \"content.subType\": \"weekly_show\" } } ] } } ] } } ] } } ] } } } }, {{/showNotList}} {{#eventNotList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"bool\":{ \"should\":[ { \"term\": { \"content.tagName\": \"{{eventNot}}\" } }, { \"term\": { \"content.id\": \"{{eventNot}}\" } } ] } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } }, { \"bool\": { \"should\": [ { \"term\": { \"content.type\": \"event\" } }, { \"bool\": { \"filter\": [ { \"term\": { \"content.type\": \"tag\" } }, { \"term\": { \"content.subType\": \"event\" } } ] } } ] } } ] } } } }, {{/eventNotList}} {{#tagNotList}} { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"term\": { \"content.tagName\": \"{{tagNot}}\" } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } } ] } } } }, { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": [ { \"term\": { \"content.id\": \"{{tagNot}}\" } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"tags\" } } } } } } ] } } } }, {{/tagNotList}} {} ] } } } }, \"highlight\": { \"fields\": { \"id\": {}, \"title\": {}, \"link\": {}, \"symbol\": {}, \"keywords\": {}, \"keypointsText\": {}, \"slug\": {}, \"transcript\": {}, \"bodyText\": {}, \"summary\": {}, \"title.compound\": {}, \"link.compound\": {}, \"keywords.compound\": {}, \"keypointsText.compound\": {}, \"slug.compound\": {}, \"summary.compound\": {} } }, \"aggs\": { \"associations\": { \"nested\": { \"path\": \"content.association\" }, \"aggs\": { \"sectionAssocs\": { \"filter\": { \"term\": { \"content.association.type\": \"section\" } }, \"aggs\": { \"nested\": { \"reverse_nested\": { \"path\": \"content\" }, \"aggs\": { \"sections\": { \"terms\": { \"field\": \"content.tagName\" } } } } } }, \"authorAssocs\": { \"filter\": { \"term\": { \"content.association.type\": \"author\" } }, \"aggs\": { \"nested\": { \"reverse_nested\": { \"path\": \"content\" }, \"aggs\": { \"authors\": { \"terms\": { \"field\": \"content.tagName\" } } } } } } } }, \"contentType\": { \"terms\": { \"field\": \"type\" } }, \"specialReports\": { \"filter\": { \"nested\": { \"path\": \"content\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.subType\": \"special_report\" } }, \"should\": [ { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"section\" } } } } } }, { \"nested\": { \"path\": \"content.association\", \"query\": { \"bool\": { \"filter\": { \"term\": { \"content.association.type\": \"additional_sections\" } } } } } } ] } } } } }, \"range\": { \"date_range\": { \"field\": \"dates.dateline\", \"format\": \"MM-dd-YYYY\", \"ranges\": [ { \"from\": \"now-y/d\", \"key\": \"past one year\" }, { \"from\": \"now-7d/d\", \"key\": \"past 7 days\" }, { \"from\": \"now/d\", \"key\": \"today\" } ] } } } } " } } 
} 